# minihost TODO

## Completed

- [x] **MIDI input** - Add API to send MIDI events to plugins (notes, CC, pitch bend)
- [x] **MIDI output** - Capture MIDI generated by plugins (arpeggiators, MIDI effects)
- [x] **State save/load** - Save and restore plugin state for presets and session recall
- [x] **Parameter metadata** - Get parameter names, labels, units, and display strings
- [x] **Transport info** - Provide BPM, time signature, playhead position for tempo-synced plugins
- [x] **Tail time** - Query and handle plugin tail (reverbs, delays) after input stops
- [x] **Bypass** - Standard bypass functionality
- [x] **Parameter enumeration** - List all parameters with their ranges and properties
- [x] **Latency compensation** - Use reported latency for proper alignment
- [x] **Sample-accurate automation** - Parameter changes at specific sample positions within a block
- [x] **Thread safety** - Locking for parameter changes from non-audio threads
- [x] **Reset** - Clear internal state between unrelated audio segments
- [x] **Non-realtime mode** - Higher-quality algorithms for offline processing
- [x] **Plugin probe** - Get metadata without full instantiation
- [x] **Parameter text conversion** - Convert between normalized values and display strings
- [x] **Factory presets** - Access built-in plugin presets
- [x] **Sidechain support** - Multiple input bus configuration
- [x] **Bus layout queries** - Query plugin I/O topology
- [x] **Sample rate change** - Change sample rate without reloading, preserving parameter state

## Future (if needed)

### Double precision processing
```c
int mh_process_double(MH_Plugin* p, const double* const* in, double* const* out, int n);
```
64-bit processing for plugins that support it. Marginal benefit for most use cases.

### Async plugin loading
```c
typedef void (*MH_LoadCallback)(MH_Plugin* p, const char* error, void* user);
int mh_open_async(const char* path, double sr, int block, int in, int out,
                  MH_LoadCallback cb, void* user);
```
Server startup with many plugins. Could be handled at application level with threads.

### Plugin scanning
```c
typedef void (*MH_ScanCallback)(const MH_PluginDesc* desc, void* user);
int mh_scan_directory(const char* path, MH_ScanCallback cb, void* user);
```
Plugin discovery. Can be built on top of `mh_probe()` by iterating directory contents.

## Non-goals

Intentionally omitted for headless/server use:

- Editor window management
- GUI hosting
- Preset browser UI
- Parameter change notifications (callbacks)
- MIDI learn
- Plugin shell/multi-instrument handling
